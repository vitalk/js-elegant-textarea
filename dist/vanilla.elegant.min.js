/* The Elegant Textarea 0.1.0 | (c) 2013-2015 Vital Kudzelka | http://opensource.org/licenses/MIT
 */
(function(w,undefined){"use strict";var Elegant=function namespace(){var doc=w.document,root=doc.documentElement,runitless=/(^-?[\d\.]+)([a-z]*)$/g,rdashed=/-([0-9]|[a-z])/gi,rtag=/^\s*<(\w+)>/;function elegant(el,opts){return new Elegant(el,opts)}function Elegant(el,opts){this.opts=opts||{};this.sel=getSelectorEngine(this.opts.sel);this.dom=getDOMEngine(this.opts.dom);if(el){var self=this;if(typeof el==="string"){this.ready(function(){for(var i=0,els=self.sel(el,root),l=els.length;i<l;i++){elegant(els[i],opts)}})}else if(typeof el==="function"){return this.ready(el)}else if(isNode(el)){this.el=el;var e=this.dom(el);if(this.opts.minHeight){this.minHeight=this.opts.minHeight=="original"?e.height():this.opts.minHeight}else{this.minHeight=0}e.css({resize:"none","overflow-y":"hidden"});var resize=function(){self.resize.call(self)};attachEvent(el,"input",resize);attachEvent(el,"propertychange",resize)}}}Elegant.prototype.resize=function(){var m,el=this.el;if(!el)return;if(!(m=getMirror(el,this.dom)))return;el=this.dom(el);el.css({height:""});el.css({height:max(m.height(),this.minHeight)})};Elegant.prototype.ready=function(fn){var ready=false,funcs=[],doit=function(){if(ready)return;while(funcs.length){funcs.shift().call(doc)}ready=true;funcs=null};attachEvent(w,"DOMContentLoaded",doit);attachEvent(w,"readystatechange",doit);attachEvent(w,"load",doit);if(doc.readyState==="complete"){doit()}return ready?fn.call(doc):funcs.push(fn)};var dom=function(){function toNode(el){return isNode(el)?el:el.el}function dom(el){return new Dom(el)}function Dom(el){var n;if(typeof el=="string"&&el!==""){var t=el.match(rtag);if(t){n=doc.createElement(t[1].toLowerCase())}else{n=doc.createElement("div");n.innerHTML=el}}else{n=toNode(el)}this.el=n;this.support=function(){return{classList:"classList"in doc.createElement("p")}}()}Dom.prototype.next=function(){var el=this.el.nextSibling;while(el&&el.nodeType!==1){el=el.nextSibling}return el&&dom(el)};Dom.prototype.html=function(h){if(typeof h=="string")this.el.innerHTML=h;else this.append(dom(h));return this};Dom.prototype.val=function(){return this.el.value};Dom.prototype.addClass=function(c){if(this.support.classList)this.el.classList.add(c);else if(!this.hasClass(c))this.el.className=this.el.className+" "+c;return this};Dom.prototype.hasClass=function(c){return this.support.classList?this.el.classList.contains(c):this.el.className.search("\b"+c+"\b")!=-1};Dom.prototype.after=function(el){this.el.parentNode.insertBefore(toNode(el),this.el.nextSibling);return this};Dom.prototype.append=function(el){this.el.appendChild(toNode(el));return this};Dom.prototype.height=function(){return w.getComputedStyle(this.el).height};Dom.prototype.css=function(o){for(var prop in o){this.el.style[camelize(prop)]=o[prop]}return this};return dom}();function isNode(el){return el&&el.nodeName&&(el.nodeType==1||el.nodeType==3)}function toStr(v){return v.toString()}function max(x,y){return unitless(x)>unitless(y)?x:y}function unitless(d){return parseInt(toStr(d).replace(runitless,"$1"))}function clone(el,dom){var propNames=["border-bottom-width","border-left-width","border-right-width","border-top-width","border-width","border-style","box-sizing","font-family","font-size","font-style","font-variant","font-weight","letter-spacing","line-height","padding-top","padding-right","padding-bottom","padding-left","text-decoration","text-transform","text-indent","width","word-spacing"];var mirror={position:"absolute",left:"-9999px",top:"0px","overflow-y":"hidden","word-wrap":"break-word","white-space":"pre-wrap"};var original=w.getComputedStyle(el);for(var prop,props={},i=0,l=propNames.length;i<l;i++){prop=propNames[i];props[prop]=original[camelize(prop)]}return dom("<div>").css(extend(props,mirror))}function getMirror(el,dom){var k,l=dom(el),m=l.next();if(m&&m.hasClass("js-elegant-mirror")){m.html("")}else{m=clone(el,dom);m.addClass("js-elegant-mirror");l.after(m)}if(l=l.val())l=dom(doc.createTextNode(l));k=dom("<span>").html("&nbsp;");if(l)m.append(l);m.append(k);return m}function attachEvent(target,type,handler){if(target.addEventListener){target.addEventListener(type,handler,false)}else if(target.attachEvent){target.attachEvent("on"+type,function(e){return handler.call(target,e)})}}function camelize(s){return s.replace(rdashed,function(s,l){return l.toUpperCase()})}function extend(o,p){for(var prop in p){if(p.hasOwnProperty(prop)){o[prop]=p[prop]}}return o}function getSelectorEngine(e){if(e)return e;else{return doc.querySelectorAll?function(s,r){return r.querySelectorAll(s)}:function(){throw new Error("Elegant: no selector engine found")}}}function getDOMEngine(fn){return fn?fn:dom}return elegant}();w.Elegant=Elegant})(this);